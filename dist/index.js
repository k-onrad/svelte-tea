"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.withMiddleware=exports.createModel=exports.provideModel=exports.useModel=void 0;var svelte_1=require("svelte"),store_1=require("svelte/store"),MODEL="undefined"!=typeof Symbol?Symbol("model"):"@model";function isObject(e){return"object"==typeof e&&null!==e}function hasProp(e,r){return r in e}function reduce(e,r,t){return t.reduce(e,r)}var useModel=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var t=svelte_1.getContext(MODEL),o=t[0],n=t[1];if(null==o)throw new Error('Context not found. Please ensure you provide the model using "provideModel" function');var i=store_1.derived(o,(function(r){return reduce((function(e,r){return isObject(e)&&hasProp(e,r)?e[r]:e}),r,e)})).subscribe;return[{subscribe:i},n]};exports.useModel=useModel;var provideModel=function(e){var r=e[0],t=e[1];svelte_1.setContext(MODEL,[r,t])};exports.provideModel=provideModel;var createModel=function(e){return function(r){var t=store_1.writable(r),o=t.subscribe,n=t.update;return[{subscribe:o},function(r){n(e(r))}]}};exports.createModel=createModel;var withMiddleware=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return function(r){return function(t){var o=exports.createModel(r)(t),n=o[0],i=o[1];if(!Array.isArray(e)||0===e.length)return[n,i];var u=function(e){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},d=[n,function(e){return u(e)}];return[n,u=e.map((function(e){return e(d)})).reduce((function(e,r){return r(e)}),i)]}}};exports.withMiddleware=withMiddleware;